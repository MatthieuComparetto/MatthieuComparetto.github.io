<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Accueil</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    introduction/résumé des jours
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">introduction</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">résume des jours</li>
    <li>
      <a href="day1.html">premier jour</a>
    </li>
    <li>
      <a href="day2.html">deuxième jour</a>
    </li>
    <li>
      <a href="day3.html">troisième jour</a>
    </li>
    <li class="dropdown-header">quatrième jour</li>
    <li class="dropdown-header">dernierjour</li>
  </ul>
</li>
<li>
  <a href="institut.html">institution/équipe de recherche</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    méthodes de classification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exemple.html">exemple introductif</a>
    </li>
    <li>
      <a href="genpop.html">application à la génétique des populations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Site important
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="inserm.html">INSERM</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="http://cesp.inserm.fr/">cesp</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<p>Dans cette partie, nous simulons des impacts de balles provenant de deux tireurs différents. Nous présentons une procédure de détection des impacts de chaque tireurs. Cela revient à mettre une couleur noir ou rouge sur chaque impact où chaque couleur caractérise un tireur. Le bloc de code suivant propose de simuler 200 impacts sur un mur. Ces lignes de code ont été réalisées sous le logiciel libre <a href="https://cran.r-project.org/"></a>. Les principaux éléments de ce codes correspondent à</p>
<ul>
<li>l’instruction <code>set.seed(123)</code> permet de rendre l’expérience de simulation reproductible</li>
<li>l’objet intitulé <code>rmixture</code> qui simule les impacts de balles où
<ul>
<li><code>n</code> est l’agrument qui contrôle le nombre d’impacts à simuler</li>
<li><code>delta</code> contrôle la différence entre les impacts des deux tireurs</li>
<li><code>d.disc</code> est le nombe de dimensions discriminantes (une seule dans notre exemple)</li>
<li><code>d.nondisc</code> est le nombe de dimensions non-discriminantes (une seule dans notre exemple)</li>
</ul></li>
</ul>
<p>Dans la suite, nous allons utiliser le terme <em>étiquette</em> pour désigner les couleurs rouge et noir qui permettent de distinguer les impacts d’un tireur de ceux de l’autre. On propose de cacher la vérité qui correspond aux étiquettes rouges et noirs des impacts et nous allons faire appel à une procédure de détection appelée <strong>algorithme des k-moyennes</strong>.</p>
<pre class="r"><code>set.seed(123)
# Fonction de generation des donnees
rmixture &lt;- function(n, delta, d.disc, d.nondisc){
  z &lt;- sample(1:2, n, replace = TRUE)
  x &lt;- matrix(rnorm(n*(d.disc+d.nondisc)), n)
  x[which(z==2), 1:d.disc] &lt;- x[which(z==2), 1:d.disc]*2 + delta
  list(x=as.data.frame(x), z=z)
}


ech &lt;- rmixture(n=200, delta=5, d.disc = 1, d.nondisc = 1)
plot(ech$x[,1], ech$x[,2], pch=&quot;+&quot;, col=ech$z, xlab=~x, ylab=~y, main=&quot;la vérité simulée&quot;)</code></pre>
<p><img src="exemple_files/figure-html/unnamed-chunk-1-1.png" width="528" /></p>
<p>L’algorithme des k-moyennes peut être résumé par les 4 étapes suivantes :</p>
<ol style="list-style-type: decimal">
<li><p>On choisit deux points moyens au hasard, un rouge et un noir.</p></li>
<li><p>On affecte une étiquette rouges aux points les plus proches du point rouge et une étiquette noir aux points les plus proches du point noir;</p></li>
<li><p>On calcule les coordonnées moyennes des points rouges et les coordonnées moyennes des points noirs qui vont jouer le rôle des deux points moyens rouge et noir.</p></li>
<li><p>On répete l’etape 2 et 3 jusqu’à ce que les deux points moyens rouge et noir se stabilisent et ne bougent plus.</p></li>
</ol>
<!-- L’algorithme ci dessous détecte la provenances des impacts de balles; On considère un tireur qui aura ses balles en noirs et un autre avec des balles en rouges. L’algorithme à 5.5% de chance de se tromper. Comme on peut voir sur le graphique, il ne suffit que d'une seule dimension pour distinguer le milieu des impacts de balles(Y) -->
<!-- grâce à l'algorithme on peut aussi savoir quel est le côté discriminant et le aussi nombre de tireur. -->
<p>Le bloc de code suivant permet de mettre en place la procédure des kmoyennes sur les 200 impacts simulés précédemment</p>
<pre class="r"><code>par(mfrow=c(1,2))
plot(ech$x[,1], ech$x[,2], pch=&quot;+&quot;, xlab=~x, ylab=~y, main=&quot;étiquettes cachées&quot;)
detect &lt;- kmeans(ech$x, 2, nstart = 100)
plot(ech$x[,1], ech$x[,2], pch=&quot;+&quot;, col = detect$cluster,
     xlab=~x, ylab=~y, main=&quot;étiquettes attribuées&quot;)</code></pre>
<p><img src="exemple_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>min(mean(ech$z!=detect$cluster), 1-mean(ech$z!=detect$cluster))</code></pre>
<pre><code>## [1] 0.055</code></pre>
<p>Comme on peut le constacter, l’affectation des couleurs des étiquettes se fait à une permutation près. L’algorithme des k-moyennes se trompes dans l’étiquetage de <span class="math inline">\(5.5\%\)</span> des impacts.</p>
<p>On s’intéresse à un autre jeu de données sous forme de deux spirales qu’on cherche à détecter automatiquement.</p>
<pre class="r"><code>require(kernlab)</code></pre>
<pre><code>## Loading required package: kernlab</code></pre>
<pre class="r"><code>data(spirals)
plot(spirals, xlab=~x, ylab=~y, main=&quot;deux spirales&quot;)</code></pre>
<p><img src="exemple_files/figure-html/unnamed-chunk-3-1.png" width="528" /></p>
<p>Ce jeu de données est intéressant par la forme des deux groupes à détecter. Cette forme spirale des deux groupes met en échec l’algorithme des k-moyennes comme on peut le remarquer sur la figure à gauche ci-dessous. En raison de la forme non-convexe des spirales, l’agorithme des k-moyennes échoue dans la détection des deux groupes.</p>
<pre class="r"><code>require(kernlab)
data(spirals)
par(mfrow=c(1,2))
plot(spirals, col = kmeans(spirals, 2)$cluster, xlab=~x, ylab=~y )
plot(spirals, col = specc(spirals, 2), xlab=~x, ylab=~y)</code></pre>
<p><img src="exemple_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Revenons au premier exemple d’attribution d’étiquettes rouges et noirs aux impacts de tirs, nous avons donné en entrée de l’algorithme des k-moyennes, le nombre de groupes qui correspond au chiffre <span class="math inline">\(2\)</span> dans l’instruction <code>kmeans(ech$x, 2, nstart = 100)</code>. Cette information est inconnu a priori dans une situation réelle. Il serait donc intéressant de mettre une place un mécanisme de choix du nombre de tireurs. Comme on peut le constater sur le même jeu de données, c’est uniquement l’abscisse d’un point qui permet de déterminer l’appartenance à une couleur ou une autre. La question de détection de dimensions discriminante est une question très importance quand il s’agît de classer des données génétiques où une dimension discriminante correspond à une position du génome qui permet de faire un diagnostic. La procédure implémentée dans la librairie <a href="http://varsellcm.r-forge.r-project.org/"></a> de  permet de répondre aux deux questions précédentes comme on peut le voir sur le bloc de code suivant. Ce libraire est le résultat des travaux des trois dernières années de recherche de mon tuteur en collaboration étroite avec son coauteur enseignant-chercheur à l’<a href="http://www.ensai.fr/">ENSAI</a> à Rennes.</p>
<pre class="r"><code>require(VarSelLCM)</code></pre>
<pre><code>## Loading required package: VarSelLCM</code></pre>
<pre><code>## 
## Attaching package: &#39;VarSelLCM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:kernlab&#39;:
## 
##     predict</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     predict</code></pre>
<pre class="r"><code>res_with &lt;- VarSelCluster(ech$x, gvals=1:6, nbcores = 8, crit.varsel = &quot;BIC&quot;)
print(res_with)</code></pre>
<pre><code>## Data set:
##    Number of individuals: 200 
##    Number of continuous variables: 2 
## 
## Model:
##    Number of components: 2 
##    Model selection has been performed according to the BIC  criterion 
##    Variable selection has been performed, 1  ( 50 % ) of the variables are relevant for clustering 
##    
## Information Criteria:
##    loglike: -745.3824 
##    AIC:     -752.3824 
##    BIC:     -763.9265 
##    ICL:     -781.7757</code></pre>
<pre class="r"><code>min(mean(ech$z!=res_with@partitions@zMAP), 1-mean(ech$z!=res_with@partitions@zMAP))</code></pre>
<pre><code>## [1] 0.065</code></pre>
<p>On reprend l’exemple d’impacts de balles sur un mur avec un nouvel algorithme. L’argument <code>gvals=1:6</code> de la fonction <code>VarSelCluster</code> permet de tester les nombre de groupes (nombre de tireurs dans cet exemple) allant de 1 à 8. La commande <code>nbcores = 8</code> permet de faire appel aux 8 coeurs du processeur pour faire le calcul en un temps plus court. Il a detecté la présence de deux tireurs, il y’a une des deux dimensions qui est inutile pour détecter le nombre de tireurs et le taux d’erreur est de 6.5%.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
